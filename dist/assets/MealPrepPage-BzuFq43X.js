import{R as e,r as l,d as N,W as S}from"./index-gcsECw-u.js";import{P}from"./PhotoGrid-NJJTFkV_.js";import{d as x,q as M,o as C,c as h,a as k,b as A,s as F}from"./firebaseConfig-Dgst5WcO.js";import"./cloudinaryImage-Zl7k-4H-.js";const v=()=>{const a={fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',fontSize:"10px"},t={mixBlendMode:"multiply"},n={fontSize:"10px",fontWeight:"bold",fill:"#000",textAnchor:"middle"},c={...n,fontSize:"8px",fill:"#FFFFFF"};return e.createElement("svg",{viewBox:"0 0 300 200",xmlns:"http://www.w3.org/2000/svg",style:a},e.createElement("circle",{cx:"115",cy:"120",r:"50",fill:"#fde047",style:t}),e.createElement("circle",{cx:"185",cy:"120",r:"50",fill:"#67e8f9",style:t}),e.createElement("circle",{cx:"150",cy:"70",r:"50",fill:"#fca5a5",style:t}),e.createElement("text",{x:"100",y:"130",style:n},"Cost Efficiency"),e.createElement("text",{x:"200",y:"130",style:n},"Local Ingredients"),e.createElement("text",{x:"150",y:"55",style:n},"Perfect Nutrition"),e.createElement("text",{x:"150",y:"105",style:c},"Foundation"),e.createElement("text",{x:"150",y:"115",style:c},"Meal Plan"))};function _({menus:a,onSelect:t}){return!a||a.length===0?e.createElement("p",{className:"text-gray-600"},"No menus yet."):e.createElement("ul",{className:"divide-y divide-gray-200 border rounded-md"},a.map(n=>e.createElement("li",{key:n._id,className:"p-4 flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"font-semibold"},n.clientName),e.createElement("p",{className:"text-sm text-gray-500"},"Week of ",n.date)),e.createElement("button",{type:"button",className:"px-3 py-1 rounded bg-gray-900 text-white text-sm",onClick:()=>t&&t(n)},"View"))))}function L({menu:a,onBack:t}){var n;return a?e.createElement("div",{className:"space-y-4"},e.createElement("button",{onClick:t,className:"text-sm text-blue-600"},"← Back"),e.createElement("h4",{className:"text-2xl font-bold"},a.clientName),e.createElement("p",{className:"text-gray-600"},"Week of ",a.date),a.notes&&e.createElement("p",{className:"italic text-gray-700"},a.notes),e.createElement("ul",{className:"list-disc ml-6"},(n=a.menu)==null?void 0:n.map((c,o)=>e.createElement("li",{key:o},c)))):null}function T({menuId:a,user:t}){const[n,c]=l.useState([]),[o,p]=l.useState(""),f=l.useRef(null);l.useEffect(()=>{if(!a||!x)return;const s=M(h(x,"mealprep_comments",a,"comments"),C("createdAt","desc")),m=k(s,r=>{c(r.docs.map(E=>({id:E.id,...E.data()})))});return()=>m()},[a]);const y=async s=>{var r;s.preventDefault();const m=o.trim();m&&x&&(await A(h(x,"mealprep_comments",a,"comments"),{body:m,createdAt:F(),uid:(t==null?void 0:t.uid)||null,name:(t==null?void 0:t.displayName)||"Anonymous"}),p(""),(r=f.current)==null||r.focus())};return e.createElement("div",{className:"mt-8 border-t pt-4"},e.createElement("h5",{className:"font-semibold mb-2"},"Comments"),t?e.createElement("form",{onSubmit:y,className:"flex gap-2 mb-4"},e.createElement("input",{ref:f,value:o,onChange:s=>p(s.target.value),className:"flex-1 border rounded px-3 py-2",placeholder:"Leave a comment"}),e.createElement("button",{className:"px-3 py-2 bg-gray-900 text-white rounded",type:"submit"},"Post")):e.createElement("p",{className:"text-sm text-gray-600"},"Sign in to comment."),e.createElement("ul",{className:"space-y-3"},n.map(s=>e.createElement("li",{key:s.id,className:"border rounded p-3"},e.createElement("p",{className:"text-sm text-gray-500"},s.name||"Anon"),e.createElement("p",null,s.body)))))}const D=()=>{const[t,n]=l.useState([]),[c,o]=l.useState(!1),[p,f]=l.useState(null),[y,s]=l.useState(null),[m]=l.useState(""),[r,E]=l.useState(null),[u,b]=l.useState(null);l.useEffect(()=>((async()=>{{E(null);return}})(),()=>{}),[null]),l.useEffect(()=>{let i=!0;return(async()=>{try{if(o(!0),f(null),!N||!N.fetch)throw new Error("Content service unavailable");const d=await N.fetch(`*[_type == "mealPrepMenu" && published == true] | order(date desc)[0...50]{
            _id, date, clientName, menu, notes
          }`);i&&n(d||[])}catch(d){i&&f(d.message||String(d))}finally{i&&o(!1)}})(),()=>{i=!1}},[null]);const w=l.useMemo(()=>{const i=r?t.filter(g=>(g.clientName||"").toLowerCase()===r.toLowerCase()):t,d=m.trim().toLowerCase();return d?i.filter(g=>(g.clientName||"").toLowerCase().includes(d)):i},[t,m,r]);return e.createElement(e.Fragment,null,e.createElement(S,null,e.createElement("title",null,"Weekly Meal Prep | Local Effort"),e.createElement("meta",{name:"description",content:"Our Foundation Meal Plan provides 21 nutritious meals per week from local Midwest sources."})),e.createElement("div",{className:"space-y-8"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-4xl md:text-6xl font-bold uppercase"},"Weekly Meal Prep"),e.createElement("div",{className:"flex items-center gap-3"})),e.createElement("p",{className:"font-mono text-lg max-w-3xl"},"Basic, good nutrition from local Midwest sources. We offer a Foundation Plan and are happy to create custom plans for any diet."),e.createElement("div",{className:"flex gap-2 items-center text-sm text-gray-700"},e.createElement("a",{href:"#menus",className:"underline"},"View current menus"),r?e.createElement("span",null,"for ",e.createElement("strong",null,r)):e.createElement("span",{className:"italic"},"no client assigned yet")),e.createElement("section",{id:"menus",className:"space-y-4"},e.createElement("h3",{className:"text-2xl font-bold"},"Current Menus"),c?e.createElement("p",null,"Loading menus…"):p?e.createElement("div",{className:"text-red-700 bg-red-50 border border-red-200 p-3 rounded"},e.createElement("p",{className:"font-semibold"},p),e.createElement("p",{className:"text-sm mt-1"},"If this persists, ensure Sanity env vars are set on the web app (VITE_APP_SANITY_PROJECT_ID, VITE_APP_SANITY_DATASET) and that the Studio has the new Meal Prep Menu content.")):y?e.createElement("div",null,e.createElement(L,{menu:y,onBack:()=>s(null)}),e.createElement(T,{menuId:y._id})):e.createElement(_,{menus:w,onSelect:s})),e.createElement(P,{tags:"mealplan",title:"Meal plan photos",perPage:24}),e.createElement("div",{className:"grid md:grid-cols-2 gap-6"},e.createElement("div",{className:"border border-gray-900 rounded-md overflow-hidden"},e.createElement("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 bg-gray-50 hover:bg-gray-100",onClick:()=>b(u==="foundation"?null:"foundation")},e.createElement("span",{className:"text-xl font-bold"},"Foundation Meal Plan"),e.createElement("span",{className:"text-sm text-gray-600"},u==="foundation"?"Hide ▲":"View More ▼")),e.createElement("div",{className:`transition-[max-height,opacity] duration-300 ease-in-out ${u==="foundation"?"max-h-[1000px] opacity-100":"max-h-0 opacity-0"} overflow-hidden`},e.createElement("div",{className:"p-6"},e.createElement(v,null),e.createElement("p",{className:"font-mono mt-6 max-w-2xl"},"Inspired by the 'Protocol' by Bryan Johnson, this plan provides up to 21 meals/week at ~1800 calories/day.")))),e.createElement("div",{className:"border border-gray-900 rounded-md overflow-hidden"},e.createElement("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 bg-gray-50 hover:bg-gray-100",onClick:()=>b(u==="custom"?null:"custom")},e.createElement("span",{className:"text-xl font-bold"},"Custom Plan"),e.createElement("span",{className:"text-sm text-gray-600"},u==="custom"?"Hide ▲":"View More ▼")),e.createElement("div",{className:`transition-[max-height,opacity] duration-300 ease-in-out ${u==="custom"?"max-h-[1000px] opacity-100":"max-h-0 opacity-0"} overflow-hidden`},e.createElement("div",{className:"p-6"},e.createElement(v,null),e.createElement("p",{className:"font-mono mt-6 max-w-2xl"},"We tailor plans to your needs (gluten-free, vegetarian, high-protein, etc.). Tell us your goals and preferences and we’ll propose a weekly plan and schedule.")))))))};export{D as MealPrepPage,D as default};
