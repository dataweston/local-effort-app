import{r as a,A as e,W as j}from"./index-LrDjm4qp.js";import{C as f}from"./cloudinaryImage-DtHPK8TW.js";const N=()=>{const[o,x]=a.useState([]),[r,p]=a.useState(""),[c,i]=a.useState(!0),[l,d]=a.useState(null);return a.useEffect(()=>{const s=setTimeout(async()=>{i(!0),d(null);try{const n=r?`tags:${r}`:"",h=`/api/search-images?query=${encodeURIComponent(n)}`;console.log("Making API call to:",h),console.log("Current location:",window.location.href);const t=await fetch(h);console.log("Response status:",t.status),console.log("Response content-type:",t.headers.get("content-type"));const u=t.headers.get("content-type");if(!u||!u.includes("application/json")){const g=await t.text();throw console.error("Non-JSON response:",g.substring(0,200)),new Error("API endpoint not found - got HTML instead of JSON")}if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const m=await t.json();console.log("API Response data:",m),x(m.images||[])}catch(n){console.error("Error fetching images:",n),d(n.message)}finally{i(!1)}},500);return()=>clearTimeout(s)},[r]),e.jsxs(e.Fragment,{children:[e.jsx(j,{children:e.jsx("title",{children:"Pictures of Food | Local Effort"})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4 text-center",children:"Image Gallery"}),e.jsxs("div",{className:"bg-gray-100 p-4 mb-4 rounded text-sm",children:[e.jsx("h3",{className:"font-bold",children:"Debug Info:"}),e.jsxs("p",{children:["Loading: ",c.toString()]}),e.jsxs("p",{children:["Error: ",l||"None"]}),e.jsxs("p",{children:["Images count: ",o.length]}),e.jsxs("p",{children:['Current query: "',r,'"']}),e.jsxs("p",{children:["Current URL: ",window.location.href]}),e.jsx("p",{children:"API URL: /api/search-images.js"})]}),e.jsx("input",{type:"text",value:r,onChange:s=>p(s.target.value),placeholder:"Search by tag (e.g., pizza, events)...",className:"w-full max-w-md mx-auto block p-3 border rounded-md mb-8"}),c?e.jsx("p",{children:"Loading..."}):l?e.jsxs("div",{className:"text-red-600 bg-red-50 p-4 rounded",children:[e.jsx("h3",{className:"font-bold",children:"Error Details:"}),e.jsx("p",{children:l}),e.jsx("p",{className:"mt-2 text-sm",children:"This usually means:"}),e.jsxs("ul",{className:"list-disc ml-6 text-sm",children:[e.jsx("li",{children:"The /api/search-images.js file wasn't created properly"}),e.jsx("li",{children:"Environment variables aren't set in Vercel"}),e.jsx("li",{children:"The serverless function has an error"})]}),e.jsx("p",{className:"mt-2 text-sm",children:"Check the browser Network tab and Vercel function logs."})]}):o.length===0?e.jsxs("div",{className:"text-center p-8",children:[e.jsx("p",{children:"No images found."}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Try removing search terms or check that you have images in your Cloudinary account."})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:o.map(s=>(console.log("Rendering image:",s.public_id),e.jsxs("div",{className:"border p-2",children:[e.jsx(f,{publicId:s.public_id,alt:s.context?.alt||"Gallery image",width:400,height:400,className:"rounded-lg object-cover w-full h-full aspect-square"}),e.jsxs("p",{className:"text-xs mt-2 text-gray-600",children:["ID: ",s.public_id]})]},s.asset_id)))})]})]})};export{N as default};
