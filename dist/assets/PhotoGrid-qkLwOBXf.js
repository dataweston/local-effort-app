import{r as o,R as t}from"./index-HZZRY-Ak.js";import{C as E}from"./cloudinaryImage-DKxFx2vc.js";function S({tags:c,title:m,perPage:f=24,layout:w,masonry:N=!1}){const i=o.useMemo(()=>Array.isArray(c)?c.filter(Boolean):[c].filter(Boolean),[c]),[d,p]=o.useState([]),[_,h]=o.useState(!1),[b,g]=o.useState(null);if(o.useEffect(()=>{let e=!1;const l=new AbortController;return(async()=>{if(!i.length){p([]);return}h(!0),g(null);try{const a=i.map(async s=>{const n=await fetch(`/api/search-images?query=${encodeURIComponent(s)}&per_page=${f}`,{signal:l.signal}),u=await n.json().catch(()=>({}));if(!n.ok)throw new Error(u.error||`Failed loading tag ${s}`);return Array.isArray(u.images)?u.images:[]}),r=await Promise.all(a);if(e)return;const x=[].concat(...r),y=new Set,I=x.filter(s=>{const n=s.asset_id||s.public_id||s.publicId;return!n||y.has(n)?!1:(y.add(n),!0)});p(I)}catch(a){if(e)return;g(a.message||String(a))}finally{e||h(!1)}})(),()=>{e=!0,l.abort()}},[i.join(","),f]),!i.length)return null;const v=N||String(w||"").toLowerCase()==="masonry";return t.createElement("section",{className:"space-y-4"},m?t.createElement("h3",{className:"text-2xl font-bold"},m):null,_?t.createElement("p",null,"Loading photosâ€¦"):b?t.createElement("div",{className:"text-red-700 bg-red-50 border border-red-200 p-3 rounded"},t.createElement("p",{className:"font-semibold"},b),t.createElement("p",{className:"text-sm mt-1"},"If this persists, check Cloudinary env vars and the serverless function logs.")):d.length===0?t.createElement("p",{className:"text-sm text-gray-600"},"No photos found."):v?t.createElement("div",{className:"columns-2 md:columns-3 lg:columns-4 gap-4 [column-fill:_balance]"},d.map((e,l)=>{var a,r;return t.createElement("div",{key:(e.asset_id||e.public_id||l)+":"+l,className:"mb-4 break-inside-avoid border p-2 bg-white rounded-lg overflow-hidden"},e.thumbnail_url?t.createElement("img",{src:e.thumbnail_url,alt:((a=e.context)==null?void 0:a.alt)||"Grid image",className:"rounded-lg w-full h-auto",loading:"lazy"}):t.createElement(E,{publicId:e.public_id||e.publicId,alt:((r=e.context)==null?void 0:r.alt)||"Grid image",width:800,className:"rounded-lg w-full h-auto"}))})):t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},d.map((e,l)=>{var a,r;return t.createElement("div",{key:(e.asset_id||e.public_id||l)+":"+l,className:"border p-2 bg-white rounded-lg overflow-hidden"},e.thumbnail_url?t.createElement("img",{src:e.thumbnail_url,alt:((a=e.context)==null?void 0:a.alt)||"Grid image",className:"rounded-lg object-cover w-full h-full aspect-square",loading:"lazy"}):t.createElement(E,{publicId:e.public_id||e.publicId,alt:((r=e.context)==null?void 0:r.alt)||"Grid image",width:600,height:600,className:"rounded-lg object-cover w-full h-full aspect-square"}))})))}export{S as P};
