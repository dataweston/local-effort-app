import{r as n,R as t}from"./index-gcsECw-u.js";import{C as v}from"./cloudinaryImage-Zl7k-4H-.js";function I({tags:o,title:u,perPage:m=24}){const c=n.useMemo(()=>Array.isArray(o)?o.filter(Boolean):[o].filter(Boolean),[o]),[f,p]=n.useState([]),[E,g]=n.useState(!1),[h,b]=n.useState(null);return n.useEffect(()=>{let e=!1;const l=new AbortController;return(async()=>{if(!c.length){p([]);return}g(!0),b(null);try{const r=c.map(async a=>{const s=await fetch(`/api/search-images?query=${encodeURIComponent(a)}&per_page=${m}`,{signal:l.signal}),d=await s.json().catch(()=>({}));if(!s.ok)throw new Error(d.error||`Failed loading tag ${a}`);return Array.isArray(d.images)?d.images:[]}),i=await Promise.all(r);if(e)return;const w=[].concat(...i),y=new Set,N=w.filter(a=>{const s=a.asset_id||a.public_id||a.publicId;return!s||y.has(s)?!1:(y.add(s),!0)});p(N)}catch(r){if(e)return;b(r.message||String(r))}finally{e||g(!1)}})(),()=>{e=!0,l.abort()}},[c.join(","),m]),c.length?t.createElement("section",{className:"space-y-4"},u?t.createElement("h3",{className:"text-2xl font-bold"},u):null,E?t.createElement("p",null,"Loading photosâ€¦"):h?t.createElement("div",{className:"text-red-700 bg-red-50 border border-red-200 p-3 rounded"},t.createElement("p",{className:"font-semibold"},h),t.createElement("p",{className:"text-sm mt-1"},"If this persists, check Cloudinary env vars and the serverless function logs.")):f.length===0?t.createElement("p",{className:"text-sm text-gray-600"},"No photos found."):t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},f.map((e,l)=>{var r,i;return t.createElement("div",{key:(e.asset_id||e.public_id||l)+":"+l,className:"border p-2 bg-white rounded-lg overflow-hidden"},e.thumbnail_url?t.createElement("img",{src:e.thumbnail_url,alt:((r=e.context)==null?void 0:r.alt)||"Grid image",className:"rounded-lg object-cover w-full h-full aspect-square",loading:"lazy"}):t.createElement(v,{publicId:e.public_id||e.publicId,alt:((i=e.context)==null?void 0:i.alt)||"Grid image",width:600,height:600,className:"rounded-lg object-cover w-full h-full aspect-square"}))}))):null}export{I as P};
