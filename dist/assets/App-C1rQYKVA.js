import{r as i,R as e}from"./index-CUxUiH5k.js";import{o as Ce,a as $,f as b,y as me,e as V,d as ae,h as _,w as re,x as q,z as Ye,A as fe,B as Pe,F as Oe}from"./firebaseConfig-Bigt3ZOc.js";import{P as xe,F as Ie}from"./plus-BWWaE0Y3.js";import{C as ye}from"./calendar-DYnWpZLi.js";import{D as he,T as Ve,S as Ee,a as we}from"./trash-2-bHhyascz.js";import{X as ce,C as J,a as W,T as ve}from"./x-SzTOgGEf.js";function Ne(E){const G=new Date().toISOString().slice(0,16).replace("T"," "),C=(E||"").trim().split(/\s+/).slice(0,6).join(" ").replace(/\s+/g," ").replace(/[^\w\s.-]/g,"").trim();return C?`${G} — ${C}`:`Note ${G}`}function Ge(){var z;const[E,y]=i.useState([]),[G,w]=i.useState([]),[C,M]=i.useState(null),[U,X]=i.useState(!1),[B,D]=i.useState(""),[K,Q]=i.useState(!1),[v,Z]=i.useState(null),Y=i.useRef(null),H=i.useMemo(()=>new Set(["dataweston@gmail.com","colsen03@gmail.com"]),[]),x=async()=>{var a,n,l;try{const m=await((l=(n=(a=$)==null?void 0:a.currentUser)==null?void 0:n.getIdToken)==null?void 0:l.call(n));return m?{Authorization:`Bearer ${m}`}:{}}catch{return{}}};i.useEffect(()=>{const a=Ce($,n=>{Z(n),Q(!0)});return()=>a()},[]),i.useEffect(()=>{if(b){if(!K)return;const a=((v==null?void 0:v.email)||"").toLowerCase();if(!v||!H.has(a)){D(v?"Not authorized for notes":"Not signed in");return}const n=me(V(b,"notes"),l=>{D("");const m=l.docs.map(f=>({id:f.id,...f.data()}));m.sort((f,S)=>{var O,o;return(((O=S.updatedAt)==null?void 0:O.seconds)||0)-(((o=f.updatedAt)==null?void 0:o.seconds)||0)}),y(m),!C&&m.length&&(M(m[0].id),w(f=>f.includes(m[0].id)?f:[...f,m[0].id]))},l=>D(l&&(l.code?`${l.code}: ${l.message}`:l.message)));return()=>n()}else(async()=>{try{const a=await x(),m=((await(await fetch("/api/notes",{headers:{...a}})).json()).items||[]).sort((f,S)=>{var O,o;return(((O=S.updatedAt)==null?void 0:O.seconds)||0)-(((o=f.updatedAt)==null?void 0:o.seconds)||0)});y(m),!C&&m.length&&(M(m[0].id),w(f=>f.includes(m[0].id)?f:[...f,m[0].id]))}catch{}})()},[b,K,v]);const p=i.useMemo(()=>E.find(a=>a.id===C)||null,[E,C]),k=i.useCallback(()=>{var n;if(!((n=$)!=null&&n.currentUser))return D("Not signed in"),!1;const a=($.currentUser.email||"").toLowerCase();return H.has(a)?!0:(D("Not authorized"),!1)},[H]),R=i.useCallback(async()=>{if(b){if(!k())return;const a={title:`Note ${new Date().toLocaleString()}`,content:"",createdAt:_(),updatedAt:_()},n=await ae(V(b,"notes"),a);w(l=>[...l,n.id]),M(n.id)}else try{const a=await x(),l=await(await fetch("/api/notes",{method:"POST",headers:{"content-type":"application/json",...a},body:JSON.stringify({title:`Note ${new Date().toLocaleString()}`,content:""})})).json();if(l.id){w(S=>[...S,l.id]),M(l.id);const f=await(await fetch("/api/notes",{headers:{...a}})).json();y(f.items||[])}}catch{}},[k]),ne=a=>w(n=>n.filter(l=>l!==a)),P=i.useCallback((a,n)=>{X(!0),Y.current&&window.clearTimeout(Y.current),Y.current=window.setTimeout(async()=>{var l;try{const m=((l=n.title)==null?void 0:l.trim())||Ne(n.content||"");if(b){if(!k())return;await re(q(b,"notes",a),{...n,title:m,updatedAt:_()})}else{const f=await x();await fetch(`/api/notes/${a}`,{method:"PUT",headers:{"content-type":"application/json",...f},body:JSON.stringify({title:m,content:n.content})})}}catch(m){D((m==null?void 0:m.message)||String(m))}finally{X(!1)}},400)},[k]),h=i.useCallback(async a=>{try{const n=await fetch("/api/blog/publish",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({title:a.title||"Untitled",text:a.content||"",emailOnPublish:!0})});if(!n.ok)throw new Error(await n.text());const l=await n.json().catch(()=>({})),m=l==null?void 0:l.slug;if(m){const f=`/weekly/${m}`;window.confirm(`Published! Open the post now?
${window.location.origin}${f}`)&&window.open(f,"_blank","noopener")}else alert("Published to blog and emailed (if configured).")}catch(n){alert("Publish failed: "+((n==null?void 0:n.message)||String(n)))}},[]),T=i.useCallback(async a=>{if(a&&window.confirm("Delete this note? This cannot be undone."))try{if(b){if(!k())return;await re(q(b,"notes",a),{_deleted:!0,updatedAt:_()})}else{const n=await x();await fetch(`/api/notes/${a}`,{method:"DELETE",headers:{...n}})}y(n=>n.filter(l=>l.id!==a)),w(n=>n.filter(l=>l!==a)),M(n=>n===a?null:n)}catch(n){D((n==null?void 0:n.message)||String(n))}},[k,x,b]),A=i.useCallback(async()=>{var n;const a=p;if(a)try{const l=((n=a.title)==null?void 0:n.trim())||Ne(a.content||"");if(b){if(!k())return;await re(q(b,"notes",a.id),{title:l,content:a.content||"",updatedAt:_()})}else{const m=await x();await fetch(`/api/notes/${a.id}`,{method:"PUT",headers:{"content-type":"application/json",...m},body:JSON.stringify({title:l,content:a.content||""})})}}catch(l){D((l==null?void 0:l.message)||String(l))}},[p,k]);return e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-3 border-b flex items-center justify-between"},e.createElement("div",{className:"flex items-center gap-3"},e.createElement("h3",{className:"text-lg font-semibold"},"Notepad"),e.createElement("span",{className:"text-xs text-gray-500"},U?"Saving…":"Autosave on"),B&&e.createElement("span",{className:"text-xs text-red-600"},B)),e.createElement("div",{className:"flex items-center gap-2"},p&&e.createElement("button",{onClick:A,className:"px-3 py-1.5 text-sm bg-slate-600 text-white rounded hover:bg-slate-700"},"Save Now"),e.createElement("button",{onClick:R,className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded hover:bg-blue-700"},"New Note"))),e.createElement("div",{className:"px-3 pt-2 flex gap-2 overflow-x-auto border-b"},G.map(a=>{const n=E.find(m=>m.id===a);if(!n)return null;const l=a===C;return e.createElement("button",{key:a,onClick:()=>M(a),className:`px-3 py-1.5 rounded-t ${l?"bg-white border border-gray-200 border-b-white":"bg-gray-100 border border-transparent hover:bg-gray-200"} text-sm flex items-center gap-2`},e.createElement("span",{className:"truncate max-w-[16ch]"},n.title||"Untitled"),e.createElement("span",{className:"text-gray-400 hover:text-gray-600",onClick:m=>{m.stopPropagation(),ne(a)}},"×"))})),e.createElement("div",{className:"grid md:grid-cols-[1fr_280px] gap-0"},e.createElement("div",{className:"p-3"},p?e.createElement("div",{className:"space-y-2"},e.createElement("input",{className:"w-full px-3 py-2 border rounded",value:p.title||"",onChange:a=>P(p.id,{...p,title:a.target.value}),placeholder:"Title"}),e.createElement("textarea",{className:"w-full h-[52vh] md:h-[60vh] px-3 py-2 border rounded font-mono",value:p.content||"",onChange:a=>P(p.id,{...p,content:a.target.value}),placeholder:"Start typing…"}),e.createElement("div",{className:"flex items-center justify-between pt-1"},e.createElement("span",{className:"text-xs text-gray-500"},(z=p.updatedAt)!=null&&z.seconds?new Date(p.updatedAt.seconds*1e3).toLocaleString():""),e.createElement("button",{onClick:()=>T(p.id),className:"text-sm text-red-600 hover:text-red-700"},"Delete note"))):e.createElement("div",{className:"text-gray-500 p-6"},"Open a note or create a new one.")),e.createElement("aside",{className:"border-l bg-gray-50 p-3 min-h-[40vh]"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h4",{className:"font-semibold"},"All Notes")),e.createElement("ul",{className:"mt-2 space-y-1"},E.map(a=>e.createElement("li",{key:a.id},e.createElement("button",{className:`w-full text-left px-2 py-1 rounded ${a.id===C?"bg-white border":"hover:bg-white"}`,onClick:()=>{M(a.id),w(n=>n.includes(a.id)?n:[...n,a.id])}},e.createElement("div",{className:"text-sm font-medium truncate"},a.title||"Untitled")))),!E.length&&e.createElement("li",{className:"text-sm text-gray-500 px-2"},"No notes yet.")),p&&e.createElement("div",{className:"mt-4 border-t pt-3"},e.createElement("button",{onClick:()=>h(p),className:"w-full px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm"},"Publish to Blog + Email")))))}function ie(E){if(!E)return new Date;if(typeof E.toDate=="function")return E.toDate();const y=new Date(E);return isNaN(y.getTime())?new Date:y}const qe=()=>{const E=new Set(["dataweston@gmail.com","colsen03@gmail.com"]),[y,G]=i.useState(null),[w,C]=i.useState(!1);i.useEffect(()=>{if(!$){C(!0);return}const t=Ce($,s=>{G(s),C(!0)});return()=>t()},[]);const M=async()=>{var t,s,r;try{const c=await((r=(s=(t=$)==null?void 0:t.currentUser)==null?void 0:s.getIdToken)==null?void 0:r.call(s));return c?{Authorization:`Bearer ${c}`}:{}}catch{return{}}},[U,X]=i.useState([]),[B,D]=i.useState([]),[K,Q]=i.useState(!1),[v,Z]=i.useState(new Date),[Y,H]=i.useState("none"),[x,p]=i.useState(new Date),[k,R]=i.useState(!1),[ne,P]=i.useState(!1),[h,T]=i.useState(null),[A,z]=i.useState("calendar"),[a,n]=i.useState("monthly"),[l,m]=i.useState(new Date),[f,S]=i.useState(""),O=Pe||"unknown";i.useEffect(()=>{if(!b){S("Not connected to Firebase (missing VITE_* config).");return}if(!w)return;const t=((y==null?void 0:y.email)||"").toLowerCase();if(!y||!E.has(t))return;const s=me(V(b,"events"),r=>{const c=r.docs.map(d=>({id:d.id,...d.data(),date:ie(d.data().date),repeatUntil:ie(d.data().repeatUntil)}));X(c)},r=>{S(r&&(r.code?`${r.code}: ${r.message}`:r.message)||"Firestore error")});return()=>s()},[b,w,y]),i.useEffect(()=>{if(!b||!w)return;const t=((y==null?void 0:y.email)||"").toLowerCase();if(!y||!E.has(t))return;const s=me(V(b,"receipts"),r=>{const c=r.docs.map(d=>({id:d.id,...d.data(),date:ie(d.data().date)}));D(c)},r=>{S(r&&(r.code?`${r.code}: ${r.message}`:r.message)||"Firestore error")});return()=>s()},[b,w,y]);const[o,N]=i.useState({title:"",date:new Date,location:"",estimatedRevenue:"",estimatedFoodCost:"",estimatedLaborCost:"",status:"pending",notes:"",lists:[],repeat:"none",repeatUntil:new Date}),[L,ee]=i.useState({store:"",total:"",date:new Date}),j=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),Se=()=>{const t=new Date().getFullYear(),s=new Date,r=U.filter(u=>u.date.getFullYear()===t&&u.date>=s),c=r.reduce((u,g)=>u+(g.actualRevenue||g.estimatedRevenue),0),d=r.reduce((u,g)=>u+(g.actualFoodCost||g.estimatedFoodCost),0),F=r.reduce((u,g)=>u+(g.actualLaborCost||g.estimatedLaborCost),0);return{totalFutureRevenue:c,totalFutureFoodCost:d,totalFutureLaborCost:F}},De=(t=l)=>{const s=t.getMonth(),r=t.getFullYear();return B.filter(c=>c.date.getMonth()===s&&c.date.getFullYear()===r).reduce((c,d)=>c+d.total,0)},se=()=>{var s;if(!((s=$)!=null&&s.currentUser))return S("auth: not signed in"),!1;const t=($.currentUser.email||"").toLowerCase();return E.has(t)?!0:(S("auth: not authorized"),!1)},ke=async()=>{if(!b||!se())return;const t={...o,estimatedRevenue:parseFloat(o.estimatedRevenue)||0,estimatedFoodCost:parseFloat(o.estimatedFoodCost)||0,estimatedLaborCost:parseFloat(o.estimatedLaborCost)||0,actualRevenue:o.actualRevenue||0,actualFoodCost:o.actualFoodCost||0,actualLaborCost:o.actualLaborCost||0};if(h){const s=q(b,"events",h.id);await re(s,t),T(null)}else if(await ae(V(b,"events"),t),o.repeat!=="none"){let s=new Date(o.date);const r=new Date(o.repeatUntil),c=(F,u)=>{const g=new Date(F);return g.setDate(g.getDate()+u),g},d=(F,u)=>{const g=new Date(F);return g.setMonth(g.getMonth()+u),g};for(;s<r;)o.repeat==="weekly"?s=c(s,7):o.repeat==="biweekly"?s=c(s,14):o.repeat==="monthly"&&(s=d(s,1)),s<=r&&await ae(V(b,"events"),{...t,date:s})}R(!1),N({title:"",date:new Date,estimatedRevenue:"",estimatedFoodCost:"",estimatedLaborCost:"",status:"pending",notes:"",lists:[],repeat:"none",repeatUntil:new Date})},Fe=async t=>{if(b&&se()&&window.confirm("Are you sure you want to delete this event?")){const s=q(b,"events",t);await Oe(s),R(!1),T(null)}},Me=async()=>{if(!b||!se())return;const t={...L,total:parseFloat(L.total)||0,date:new Date(L.date)};await ae(V(b,"receipts"),t),P(!1),ee({store:"",total:"",date:new Date})},te=t=>{T(t),N({...t,date:t.date,location:t.location||"",estimatedRevenue:(t.estimatedRevenue??"").toString(),estimatedFoodCost:(t.estimatedFoodCost??"").toString(),estimatedLaborCost:(t.estimatedLaborCost??"").toString()}),R(!0)},[de,ue]=i.useState("private");i.useEffect(()=>{h&&ue(h.isPublic?"public":"private")},[h]);const[le,ge]=i.useState(!1),[be,pe]=i.useState(""),Re=async()=>{if(h){ge(!0),pe("");try{const t={eventId:h.id,status:o.status||"confirmed",startDateTime:o.date?o.date.toISOString():void 0,location:o.location||void 0,visibility:de},s=await M(),r=await fetch("/api/events/confirm",{method:"POST",headers:{"Content-Type":"application/json",...s},body:JSON.stringify(t)});if(!r.ok)throw new Error(`Confirm failed: ${r.status}`);R(!1),T(null)}catch(t){pe(t.message||String(t))}finally{ge(!1)}}},Te=()=>{const t=new Date,s=x.getMonth(),r=x.getFullYear(),c=new Date(r,s,1),d=new Date(c);d.setDate(d.getDate()-c.getDay());const F=[],u=new Date(d);for(let g=0;g<42;g++){const oe=U.filter(I=>I.date.toDateString()===u.toDateString());F.push({date:new Date(u),isCurrentMonth:u.getMonth()===s,isToday:u.toDateString()===t.toDateString(),events:oe}),u.setDate(u.getDate()+1)}return e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},x.toLocaleDateString("en-US",{month:"long",year:"numeric"})),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("button",{onClick:()=>p(new Date(x.getFullYear(),x.getMonth()-1)),className:"p-1 hover:bg-gray-100 rounded"},e.createElement(J,{className:"w-5 h-5"})),e.createElement("button",{onClick:()=>p(new Date),className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200"},"Today"),e.createElement("button",{onClick:()=>p(new Date(x.getFullYear(),x.getMonth()+1)),className:"p-1 hover:bg-gray-100 rounded"},e.createElement(W,{className:"w-5 h-5"})))),e.createElement("div",{className:"grid grid-cols-7 gap-0 text-sm"},["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(g=>e.createElement("div",{key:g,className:"p-3 text-center font-medium text-gray-500 border-b border-gray-100"},g)),F.map((g,oe)=>e.createElement("div",{key:oe,className:`min-h-24 p-2 border-b border-r border-gray-100 ${g.isCurrentMonth?"bg-white hover:bg-gray-50":"bg-gray-50"} ${g.isToday?"bg-blue-50":""}`},e.createElement("div",{className:`text-sm ${g.isCurrentMonth?g.isToday?"text-blue-700 font-semibold":"text-gray-900":"text-gray-400"}`},g.date.getDate()),g.events.map(I=>e.createElement("div",{key:I.id,onClick:()=>te(I),className:`mt-1 p-1 text-xs rounded cursor-pointer truncate ${I.status==="confirmed"?"bg-green-100 text-green-800":I.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`},I.title))))))},Le=()=>{if(!b)return e.createElement("div",{className:"mb-3 p-2 text-sm rounded-md bg-yellow-50 text-yellow-800 border border-yellow-200"},"Gallant isn’t connected to Firebase. Set VITE_* Firebase env vars to your MAIN project and redeploy. Project: ",O);if(f){const t=/permission/i.test(f);return e.createElement("div",{className:`mb-3 p-2 text-sm rounded-md border ${t?"bg-red-50 text-red-800 border-red-200":"bg-yellow-50 text-yellow-800 border-yellow-200"}`},t?"Firestore permission issue.":"Firestore error."," ",f)}return null},je=()=>{const t=[];for(let s=-1;s<=1;s++){const r=new Date(x.getFullYear(),x.getMonth()+s,1);t.push(r)}return e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"3 Month View"),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("button",{onClick:()=>p(new Date(x.getFullYear(),x.getMonth()-3)),className:"p-1 hover:bg-gray-100 rounded"},e.createElement(J,{className:"w-5 h-5"})),e.createElement("button",{onClick:()=>p(new Date),className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200"},"Today"),e.createElement("button",{onClick:()=>p(new Date(x.getFullYear(),x.getMonth()+3)),className:"p-1 hover:bg-gray-100 rounded"},e.createElement(W,{className:"w-5 h-5"})))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4"},t.map((s,r)=>e.createElement("div",{key:r,className:"border border-gray-200 rounded"},e.createElement("div",{className:"p-2 bg-gray-50 font-medium text-sm text-center"},s.toLocaleDateString("en-US",{month:"long",year:"numeric"})),e.createElement("div",{className:"p-2"},U.filter(c=>c.date.getMonth()===s.getMonth()&&c.date.getFullYear()===s.getFullYear()).map(c=>e.createElement("div",{key:c.id,onClick:()=>te(c),className:`mb-1 p-2 text-xs rounded cursor-pointer ${c.status==="confirmed"?"bg-green-100 text-green-800":c.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`},e.createElement("div",{className:"font-medium"},c.title),e.createElement("div",null,c.date.getDate()))))))))},$e=()=>{const t=x.getFullYear(),s=[];for(let r=0;r<12;r++)s.push(new Date(t,r,1));return e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},t," Annual View"),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("button",{onClick:()=>p(new Date(t-1,x.getMonth())),className:"p-1 hover:bg-gray-100 rounded"},e.createElement(J,{className:"w-5 h-5"})),e.createElement("button",{onClick:()=>p(new Date),className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200"},"Current Year"),e.createElement("button",{onClick:()=>p(new Date(t+1,x.getMonth())),className:"p-1 hover:bg-gray-100 rounded"},e.createElement(W,{className:"w-5 h-5"})))),e.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4"},s.map((r,c)=>e.createElement("div",{key:c,className:"border border-gray-200 rounded"},e.createElement("div",{className:"p-2 bg-gray-50 font-medium text-sm text-center"},r.toLocaleDateString("en-US",{month:"long"})),e.createElement("div",{className:"p-2"},U.filter(d=>d.date.getMonth()===r.getMonth()&&d.date.getFullYear()===r.getFullYear()).map(d=>e.createElement("div",{key:d.id,onClick:()=>te(d),className:`mb-1 p-1 text-xs rounded cursor-pointer ${d.status==="confirmed"?"bg-green-100 text-green-800":d.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`},e.createElement("div",{className:"font-medium truncate"},d.title),e.createElement("div",null,d.date.getDate()))))))))},Ae=()=>{const{totalFutureRevenue:t,totalFutureFoodCost:s,totalFutureLaborCost:r}=Se(),c=De(),d=s+r,F=t-d;return e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6"},e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm text-gray-600"},"Future Revenue (This Year)"),e.createElement("p",{className:"text-2xl font-semibold text-green-600"},j(t))),e.createElement(ve,{className:"w-8 h-8 text-green-500"}))),e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm text-gray-600"},"Future Food Costs"),e.createElement("p",{className:"text-2xl font-semibold text-red-600"},j(s))),e.createElement(we,{className:"w-8 h-8 text-red-500"}))),e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm text-gray-600"},"Future Labor Costs"),e.createElement("p",{className:"text-2xl font-semibold text-orange-600"},j(r))),e.createElement(he,{className:"w-8 h-8 text-orange-500"})))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm text-gray-600"},"Future Gross Margin"),e.createElement("p",{className:"text-2xl font-semibold text-blue-600"},j(F))),e.createElement(ve,{className:"w-8 h-8 text-blue-500"}))),e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("div",null,e.createElement("p",{className:"text-sm text-gray-600"},"Monthly Food Spending"),e.createElement("p",{className:"text-2xl font-semibold text-gray-900"},j(c))),e.createElement(we,{className:"w-8 h-8 text-gray-500"})),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("button",{onClick:()=>m(new Date(l.getFullYear(),l.getMonth()-1)),className:"p-1 hover:bg-gray-100 rounded"},e.createElement(J,{className:"w-4 h-4"})),e.createElement("span",{className:"text-sm font-medium text-gray-700 min-w-24 text-center"},l.toLocaleDateString("en-US",{month:"short",year:"numeric"})),e.createElement("button",{onClick:()=>m(new Date(l.getFullYear(),l.getMonth()+1)),className:"p-1 hover:bg-gray-100 rounded"},e.createElement(W,{className:"w-4 h-4"}))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center"},e.createElement("h3",{className:"text-lg font-semibold"},"Receipts"),e.createElement("button",{onClick:()=>Q(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors"},e.createElement(ye,{className:"w-4 h-4"}),e.createElement("span",null,"View Receipts")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-4 border-b border-gray-200"},e.createElement("h3",{className:"text-lg font-semibold"},"Upcoming Events")),e.createElement("div",{className:"p-4"},U.filter(u=>u.date>=new Date).sort((u,g)=>u.date-g.date).slice(0,5).map(u=>e.createElement("div",{key:u.id,className:"flex justify-between items-center py-3 border-b border-gray-100 last:border-b-0 cursor-pointer hover:bg-gray-50 rounded px-2",onClick:()=>te(u)},e.createElement("div",null,e.createElement("p",{className:"font-medium text-gray-900"},u.title),e.createElement("p",{className:"text-sm text-gray-600"},u.date.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}))),e.createElement("div",{className:"text-right"},e.createElement("p",{className:"font-medium text-green-600"},j(u.estimatedRevenue)),e.createElement("p",{className:"text-sm text-gray-600"},"Food: ",j(u.estimatedFoodCost)," | Labor: ",j(u.estimatedLaborCost))))))))},Ue=()=>{const t=B.filter(r=>r.date.getMonth()===v.getMonth()&&r.date.getFullYear()===v.getFullYear()).sort((r,c)=>c.date-r.date),s=t.reduce((r,c)=>{const d=Y==="vendor"?c.store:c.id;return r[d]||(r[d]=[]),r[d].push(c),r},{});return e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto"},e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex justify-between items-center mb-4"},e.createElement("h3",{className:"text-lg font-semibold"},"Monthly Receipts"),e.createElement("button",{onClick:()=>{Q(!1)},className:"text-gray-400 hover:text-gray-600"},e.createElement(ce,{className:"w-5 h-5"}))),e.createElement("div",{className:"flex items-center space-x-2 mt-2"},e.createElement("button",{onClick:()=>Z(new Date(v.getFullYear(),v.getMonth()-1)),className:"p-1 hover:bg-gray-100 rounded"},e.createElement(J,{className:"w-4 h-4"})),e.createElement("span",{className:"text-sm font-medium text-gray-700 min-w-24 text-center"},v.toLocaleDateString("en-US",{month:"long",year:"numeric"})),e.createElement("button",{onClick:()=>Z(new Date(v.getFullYear(),v.getMonth()+1)),className:"p-1 hover:bg-gray-100 rounded"},e.createElement(W,{className:"w-4 h-4"})),e.createElement("select",{onChange:r=>H(r.target.value),value:Y,className:"ml-auto text-sm rounded border-gray-300"},e.createElement("option",{value:"none"},"Group by None"),e.createElement("option",{value:"vendor"},"Group by Vendor"))),e.createElement("div",{className:"p-4"},Object.keys(s).map(r=>e.createElement("div",{key:r},Y==="vendor"&&e.createElement("h4",{className:"font-bold mt-4 mb-2"},r),s[r].map(c=>e.createElement("div",{key:c.id,className:"flex justify-between items-center py-3 border-b border-gray-100 last:border-b-0"},e.createElement("div",null,e.createElement("p",{className:"font-medium text-gray-900"},c.store),e.createElement("p",{className:"text-sm text-gray-600"},c.date.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}))),e.createElement("div",{className:"text-right"},e.createElement("p",{className:"font-medium text-red-600"},j(c.total))))))),t.length===0&&e.createElement("p",{className:"text-gray-500 text-center py-4"},"No receipts for this month")))))};return w?y?E.has(y.email||"")?e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("header",{className:"bg-white shadow-sm border-b border-gray-200"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 py-4"},e.createElement("div",{className:"flex flex-col sm:flex-row justify-between items-center"},e.createElement("h1",{className:"text-2xl font-bold text-gray-900 mb-4 sm:mb-0"},"Local Effort Calendar and Budget"),e.createElement("div",{className:"flex items-center space-x-3"},e.createElement("button",{onClick:()=>P(!0),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors"},e.createElement(xe,{className:"w-4 h-4"}),e.createElement("span",null,"New Receipt")),e.createElement("button",{onClick:()=>{T(null),N({title:"",date:new Date,estimatedRevenue:"",estimatedFoodCost:"",estimatedLaborCost:"",status:"pending",notes:"",lists:[],repeat:"none",repeatUntil:new Date}),R(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors"},e.createElement(xe,{className:"w-4 h-4"}),e.createElement("span",null,"New Event")),e.createElement("button",{onClick:()=>fe(),className:"px-3 py-2 text-sm bg-gray-100 rounded hover:bg-gray-200"},"Sign out"))),e.createElement("nav",{className:"mt-4"},e.createElement("div",{className:"flex flex-col sm:flex-row justify-between"},e.createElement("div",{className:"flex space-x-6 mb-4 sm:mb-0"},e.createElement("button",{onClick:()=>z("calendar"),className:`pb-2 border-b-2 font-medium text-sm transition-colors ${A==="calendar"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`},e.createElement(ye,{className:"w-4 h-4 inline mr-2"}),"Calendar"),e.createElement("button",{onClick:()=>z("financials"),className:`pb-2 border-b-2 font-medium text-sm transition-colors ${A==="financials"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`},e.createElement(he,{className:"w-4 h-4 inline mr-2"}),"Financials"),e.createElement("button",{onClick:()=>z("notepad"),className:`pb-2 border-b-2 font-medium text-sm transition-colors ${A==="notepad"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`},e.createElement(Ie,{className:"w-4 h-4 inline mr-2"}),"Notepad")),A==="calendar"&&e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("button",{onClick:()=>n("monthly"),className:`px-3 py-1 text-sm rounded transition-colors ${a==="monthly"?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"}`},"Monthly"),e.createElement("button",{onClick:()=>n("3month"),className:`px-3 py-1 text-sm rounded transition-colors ${a==="3month"?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"}`},"3 Month"),e.createElement("button",{onClick:()=>n("annual"),className:`px-3 py-1 text-sm rounded transition-colors ${a==="annual"?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"}`},"Annual")))))),e.createElement("main",{className:"max-w-7xl mx-auto px-4 py-8"},Le(),A==="calendar"?a==="monthly"?Te():a==="3month"?je():$e():A==="financials"?Ae():e.createElement(Ge,null)),k&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-screen overflow-y-auto"},e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex justify-between items-center mb-4"},e.createElement("h3",{className:"text-lg font-semibold"},h?"Edit Event":"New Event"),e.createElement("button",{onClick:()=>{R(!1),T(null)},className:"text-gray-400 hover:text-gray-600"},e.createElement(ce,{className:"w-5 h-5"}))),e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{htmlFor:"event-title",className:"block text-sm font-medium text-gray-700 mb-1"},"Event Title"),e.createElement("input",{id:"event-title",type:"text",value:o.title,onChange:t=>N({...o,title:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter event title"})),e.createElement("div",null,e.createElement("label",{htmlFor:"event-date",className:"block text-sm font-medium text-gray-700 mb-1"},"Date"),e.createElement("input",{id:"event-date",type:"date",value:o.date.toISOString().split("T")[0],onChange:t=>N({...o,date:new Date(t.target.value.replace(/-/g,"/"))}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})),e.createElement("div",null,e.createElement("label",{htmlFor:"event-location",className:"block text-sm font-medium text-gray-700 mb-1"},"Location"),e.createElement("input",{id:"event-location",type:"text",value:o.location,onChange:t=>N({...o,location:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Venue, city"})),e.createElement("div",null,e.createElement("label",{htmlFor:"event-estimated-revenue",className:"block text-sm font-medium text-gray-700 mb-1"},"Estimated Revenue"),e.createElement("input",{id:"event-estimated-revenue",type:"number",value:o.estimatedRevenue,onChange:t=>N({...o,estimatedRevenue:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})),e.createElement("div",{className:"grid grid-cols-2 gap-3"},e.createElement("div",null,e.createElement("label",{htmlFor:"event-estimated-food",className:"block text-sm font-medium text-gray-700 mb-1"},"Estimated Food Cost"),e.createElement("input",{id:"event-estimated-food",type:"number",value:o.estimatedFoodCost,onChange:t=>N({...o,estimatedFoodCost:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})),e.createElement("div",null,e.createElement("label",{htmlFor:"event-estimated-labor",className:"block text-sm font-medium text-gray-700 mb-1"},"Estimated Labor Cost"),e.createElement("input",{id:"event-estimated-labor",type:"number",value:o.estimatedLaborCost,onChange:t=>N({...o,estimatedLaborCost:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"}))),e.createElement("div",null,e.createElement("label",{htmlFor:"event-status",className:"block text-sm font-medium text-gray-700 mb-1"},"Status"),e.createElement("select",{id:"event-status",value:o.status,onChange:t=>N({...o,status:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},e.createElement("option",{value:"pending"},"Pending"),e.createElement("option",{value:"confirmed"},"Confirmed"),e.createElement("option",{value:"completed"},"Completed"),e.createElement("option",{value:"cancelled"},"Cancelled"))),!h&&e.createElement("div",{className:"grid grid-cols-2 gap-3"},e.createElement("div",null,e.createElement("label",{htmlFor:"event-repeat",className:"block text-sm font-medium text-gray-700 mb-1"},"Repeat"),e.createElement("select",{id:"event-repeat",value:o.repeat,onChange:t=>N({...o,repeat:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},e.createElement("option",{value:"none"},"None"),e.createElement("option",{value:"weekly"},"Weekly"),e.createElement("option",{value:"biweekly"},"Bi-weekly"),e.createElement("option",{value:"monthly"},"Monthly"))),o.repeat!=="none"&&e.createElement("div",null,e.createElement("label",{htmlFor:"event-repeat-until",className:"block text-sm font-medium text-gray-700 mb-1"},"Repeat Until"),e.createElement("input",{id:"event-repeat-until",type:"date",value:o.repeatUntil.toISOString().split("T")[0],onChange:t=>N({...o,repeatUntil:new Date(t.target.value.replace(/-/g,"/"))}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}))),e.createElement("div",null,e.createElement("label",{htmlFor:"event-notes",className:"block text-sm font-medium text-gray-700 mb-1"},"Notes"),e.createElement("textarea",{id:"event-notes",value:o.notes,onChange:t=>N({...o,notes:t.target.value}),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Add any notes about this event..."}))),e.createElement("div",{className:"mt-6 flex justify-between"},e.createElement("div",null,h&&e.createElement("button",{onClick:()=>Fe(h.id),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors flex items-center"},e.createElement(Ve,{className:"w-4 h-4 inline mr-2"}),"Delete Event")),e.createElement("div",{className:"flex flex-col sm:flex-row gap-3 sm:items-center"},h&&e.createElement("div",{className:"flex items-center gap-2"},e.createElement("label",{htmlFor:"confirm-visibility",className:"text-sm text-gray-700"},"Publish:"),e.createElement("select",{id:"confirm-visibility",value:de,onChange:t=>ue(t.target.value),className:"text-sm rounded border-gray-300"},e.createElement("option",{value:"private"},"Private"),e.createElement("option",{value:"public"},"Public")),e.createElement("button",{onClick:Re,disabled:le,className:`px-3 py-2 text-sm font-medium text-white rounded-md transition-colors ${le?"bg-gray-400":"bg-emerald-600 hover:bg-emerald-700"}`},le?"Confirming…":"Confirm")),e.createElement("div",{className:"flex space-x-3 ml-auto"},e.createElement("button",{onClick:()=>{R(!1),T(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"},"Cancel"),e.createElement("button",{onClick:ke,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors"},e.createElement(Ee,{className:"w-4 h-4 inline mr-2"}),"Save Event"))),h&&e.createElement("div",{className:"mt-3"},e.createElement("p",{className:"text-xs text-gray-500"},"Status: ",e.createElement("span",{className:`px-1.5 py-0.5 rounded ${o.status==="confirmed"?"bg-green-100 text-green-700":o.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`},o.status)),typeof h.isPublic<"u"&&e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Visibility: ",e.createElement("span",{className:`px-1.5 py-0.5 rounded ${h.isPublic?"bg-emerald-100 text-emerald-700":"bg-gray-100 text-gray-700"}`},h.isPublic?"Public":"Private")),h.publicEventId&&e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Public Event ID: ",e.createElement("span",{className:"font-mono"},h.publicEventId)),be&&e.createElement("p",{className:"text-xs text-red-600 mt-1"},be)))))),ne&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full"},e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex justify-between items-center mb-4"},e.createElement("h3",{className:"text-lg font-semibold"},"New Receipt"),e.createElement("button",{onClick:()=>{P(!1)},className:"text-gray-400 hover:text-gray-600"},e.createElement(ce,{className:"w-5 h-5"}))),e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{htmlFor:"receipt-store",className:"block text-sm font-medium text-gray-700 mb-1"},"Store"),e.createElement("input",{id:"receipt-store",type:"text",value:L.store,onChange:t=>ee({...L,store:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter store name"})),e.createElement("div",null,e.createElement("label",{htmlFor:"receipt-total",className:"block text-sm font-medium text-gray-700 mb-1"},"Total"),e.createElement("input",{id:"receipt-total",type:"number",step:"0.01",value:L.total,onChange:t=>ee({...L,total:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"0.00"})),e.createElement("div",null,e.createElement("label",{htmlFor:"receipt-date",className:"block text-sm font-medium text-gray-700 mb-1"},"Date"),e.createElement("input",{id:"receipt-date",type:"date",value:L.date.toISOString().split("T")[0],onChange:t=>ee({...L,date:new Date(t.target.value.replace(/-/g,"/"))}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",{className:"mt-6 flex justify-end space-x-3"},e.createElement("button",{onClick:()=>{P(!1)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"},"Cancel"),e.createElement("button",{onClick:Me,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-md transition-colors"},e.createElement(Ee,{className:"w-4 h-4 inline mr-2"}),"Save Receipt"))))),K&&Ue()):e.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-6"},e.createElement("div",{className:"bg-white border rounded-lg shadow-sm p-6 max-w-md w-full text-center"},e.createElement("h2",{className:"text-xl font-semibold mb-2"},"Access Denied"),e.createElement("p",{className:"text-sm text-gray-600 mb-4"},"Your account is not authorized for Gallant tools."),e.createElement("button",{onClick:()=>fe(),className:"px-4 py-2 bg-gray-100 rounded hover:bg-gray-200"},"Sign out"))):e.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-6"},e.createElement("div",{className:"bg-white border rounded-lg shadow-sm p-6 max-w-md w-full text-center"},e.createElement("h2",{className:"text-xl font-semibold mb-2"},"Gallant Hawking"),e.createElement("p",{className:"text-sm text-gray-600 mb-4"},"Sign in with Google to access tools."),e.createElement("button",{onClick:()=>Ye(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},"Sign in with Google"))):e.createElement("div",{className:"p-6"},"Loading…")};export{qe as default};
