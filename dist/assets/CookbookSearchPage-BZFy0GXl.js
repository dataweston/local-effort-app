import{k as y,r as a,R as t}from"./index-CUxUiH5k.js";const E={};function N(r,c=300){const[s,l]=a.useState(r);return a.useEffect(()=>{const o=setTimeout(()=>l(r),c);return()=>clearTimeout(o)},[r,c]),s}function k(){const[r,c]=y(),[s,l]=a.useState(r.get("q")||""),[o,u]=a.useState([]),[d,p]=a.useState(!1),[g,h]=a.useState(""),i=a.useMemo(()=>{const e=import.meta&&E?E:{};return e.VITE_COOKBOOK_API_URL||e.VITE_API_URL||e.NEXT_PUBLIC_API_URL||"http://localhost:8000"},[]),b=N(s,350);return a.useEffect(()=>{const e=r.get("q")||"";if(s!==e){const n=new URLSearchParams(r);s?n.set("q",s):n.delete("q"),c(n,{replace:!0})}},[s,r,c]),a.useEffect(()=>{let e=!1;async function n(){p(!0),h("");try{const x=`${i}/api/search?q=${encodeURIComponent(b)}`,m=await fetch(x,{headers:{Accept:"application/json"}});if(!m.ok)throw new Error(`API ${m.status}`);const f=await m.json();e||u(Array.isArray(f.results)?f.results:[])}catch{e||(h("Search API unavailable. Start docker compose or API service."),u([]))}finally{e||p(!1)}}return n(),()=>{e=!0}},[i,b]),t.createElement("div",{className:"mx-auto max-w-5xl px-4 py-10"},t.createElement("div",{className:"mb-8"},t.createElement("h1",{className:"text-3xl font-semibold tracking-tight"},"Cookbook Search"),t.createElement("p",{className:"text-gray-600 mt-2"},"Search parsed recipes once the index is built. API base: ",t.createElement("code",null,i))),t.createElement("form",{className:"flex gap-3 mb-6",onSubmit:e=>{e.preventDefault()}},t.createElement("input",{value:s,onChange:e=>l(e.target.value),placeholder:"Search by title, ingredient, instruction…",className:"flex-1 rounded-md border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.createElement("button",{type:"submit",className:"rounded-md bg-blue-600 px-5 py-2 text-white hover:bg-blue-700"},d?"Searching…":"Search")),g?t.createElement("div",{className:"mb-6 rounded-md border border-yellow-300 bg-yellow-50 p-3 text-yellow-800"},g):null,t.createElement("div",{className:"mt-4"},d&&o.length===0?t.createElement("div",{className:"text-gray-500"},"Loading…"):o.length===0?t.createElement("div",{className:"text-gray-500"},"No results yet."):t.createElement("ul",{className:"divide-y divide-gray-200 rounded-md border border-gray-200"},o.map(e=>{var n;return t.createElement("li",{key:e.id,className:"p-4 hover:bg-gray-50"},t.createElement("a",{href:`/recipes/${e.id}`,className:"block"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("h3",{className:"text-lg font-medium"},e.title||e.id),e.source?t.createElement("span",{className:"text-xs uppercase tracking-wide text-gray-500"},e.source):null),Array.isArray(e.ingredients)&&e.ingredients.length>0?t.createElement("p",{className:"mt-1 line-clamp-2 text-sm text-gray-600"},e.ingredients.slice(0,3).join(" • ")):null,(n=e.highlight)!=null&&n.instructions?t.createElement("p",{className:"mt-1 text-sm text-gray-600",dangerouslySetInnerHTML:{__html:e.highlight.instructions.join(" … ")}}):null))}))),t.createElement("div",{className:"mt-10 text-sm text-gray-500"},t.createElement("p",null,"Tip: Start services with Docker Compose in ",t.createElement("code",null,"cookbook/repo")," and bulk-index documents to enable search."),t.createElement("pre",{className:"mt-2 whitespace-pre-wrap rounded bg-gray-100 p-3 text-xs"},`# From cookbook/repo
docker compose up -d
python -m indexing.bulk_index --data ./data --index recipes`)))}export{k as default};
